---
title: Self-Hosted GPU Container
description: Deploy GPU avatar workers on your infrastructure with full control over scaling and data privacy.
---

Deploy production-grade GPU avatar generation on your own cloud infrastructure.

**Pricing**: 2 credits per minute while using the GPU container.

## Quick Start

### Pull and Run

```bash
docker pull docker.io/bithumanhubs/expression-avatar:latest

docker run --gpus all -p 8089:8089 \
    -v /path/to/model-storage:/persistent-storage/avatar-model \
    -e AVATAR_MODEL_DIR=/persistent-storage/avatar-model \
    docker.io/bithumanhubs/expression-avatar:latest
```

### Verify

```bash
curl http://localhost:8089/health
# Returns: {"status": "ok", "active_workers": 0}
```

---

## Storage Architecture

### AVATAR_MODEL_DIR (Required)

Stores the avatar generation models required for all avatar processing.

- **Mandatory** for all avatar generation
- **Auto-download** on first container startup
- **Persistent storage recommended** to avoid re-downloading on restart
- **Size**: approximately 2-3 GB

### PRESET_AVATARS_DIR (Optional)

Stores pre-encoded avatar reference images for faster startup.

```
/persistent-storage/preset-avatars/
├── avatar_001/
│   └── face.jpg
├── avatar_002/
│   └── portrait.png
└── avatar_003/
    └── avatar.webp
```

Each subdirectory name becomes the `avatar_id`. Images are pre-encoded and cached in memory at startup.

---

## Performance

| Configuration | Time to First Frame | Description |
|---------------|---------------------|-------------|
| Long-running + Preset | ~4 seconds | Pre-processed, minimal GPU init |
| Long-running + No Cache | ~6 seconds | Processing on first request |
| Cold Start | ~30-40 seconds | Full engine initialization |

**Supported image formats:** `.jpg`, `.jpeg`, `.png`, `.webp`

---

## Storage Recommendations

| Component | Size | Required |
|-----------|------|----------|
| AVATAR_MODEL_DIR | ~2-3 GB | Yes |
| PRESET_AVATARS_DIR | Varies | Recommended |

---

## Docker Configuration

```bash
docker run --gpus all -p 8089:8089 \
    -v /path/to/model-storage:/persistent-storage/avatar-model \
    -v /path/to/preset-avatars:/persistent-storage/preset-avatars \
    -e AVATAR_MODEL_DIR=/persistent-storage/avatar-model \
    -e PRESET_AVATARS_DIR=/persistent-storage/preset-avatars \
    docker.io/bithumanhubs/expression-avatar:latest
```

**Image requirements for presets:**
- High-quality portrait (512x512 recommended)
- Front-facing with visible face
- Good lighting, neutral expression
- Under 10MB per image

---

## Troubleshooting

**Container won't start?**
1. Check GPU availability: `nvidia-smi`
2. Verify storage volume mount
3. Check logs: `docker logs <container-id>`

**High first frame latency (>10s)?**
1. Configure PRESET_AVATARS_DIR
2. Use long-running containers instead of cold start
3. Increase GPU memory allocation

**Out of memory?**
1. Increase container memory limit
2. Use larger GPU instance
3. Limit concurrent requests per container

---

## Advantages

- **Full Control** — Complete control over deployment and scaling
- **Cost Optimization** — Pay only for GPU resources you use
- **Data Privacy** — Avatar images and audio never leave your infrastructure
- **Customization** — Extend the worker with custom logic

---

## Resources

- [Docker Hub Image](https://hub.docker.com/r/bithumanhubs/expression-avatar)
- [Integration Guide](https://github.com/bithuman-product/examples/tree/main/public-docs/examples/cloud/expression)
- [LiveKit Agents Documentation](https://docs.livekit.io/agents)
